---
interface Props {
  size?: number;
  class?: string;
}

const { size = 120, class: className = '' } = Astro.props;
---

<div class={`rocket-container ${className}`} style={`--rocket-size: ${size}px`}>
  <div class="rocket-wrapper">
    <svg class="rocket-svg" viewBox="0 0 36 42" fill="none" xmlns="http://www.w3.org/2000/svg">
      <defs>
        <linearGradient id="flame-core" x1="0" y1="0" x2="0" y2="1">
          <stop offset="0%" stop-color="#FFF3B0"/>
          <stop offset="40%" stop-color="#FFB347"/>
          <stop offset="100%" stop-color="#D97757"/>
        </linearGradient>
        <linearGradient id="flame-outer" x1="0" y1="0" x2="0" y2="1">
          <stop offset="0%" stop-color="#EDAA85"/>
          <stop offset="100%" stop-color="#D9775700"/>
        </linearGradient>
        <filter id="flame-glow" x="-50%" y="-50%" width="200%" height="200%">
          <feGaussianBlur in="SourceGraphic" stdDeviation="1.5" result="blur"/>
          <feComposite in="SourceGraphic" in2="blur" operator="over"/>
        </filter>
      </defs>

      <g class="rocket-body">
        <circle cx="9" cy="4.5" r="3" fill="#D97757"/>
        <circle cx="27" cy="4.5" r="3" fill="#D97757"/>
        <path d="M5.5 19 L5.5 12.5 C5.5 6.5 10.5 2.5 18 2.5 C25.5 2.5 30.5 6.5 30.5 12.5 L30.5 19 C30.5 21.5 28.5 23.5 26 23.5 L10 23.5 C7.5 23.5 5.5 21.5 5.5 19Z" fill="#D97757"/>

        <g>
          <path d="M13 12.5 L15 14.5 L13 16.5" stroke="white" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/>
        </g>

        <g class="wink-eye">
          <path d="M23 12.5 L21 14.5 L23 16.5" stroke="white" stroke-width="1.8" stroke-linecap="round" stroke-linejoin="round"/>
        </g>
        <g class="wink-closed">
          <line x1="20.5" y1="14.5" x2="23.5" y2="14.5" stroke="white" stroke-width="1.8" stroke-linecap="round"/>
        </g>
      </g>

      <g class="flame-group flame-left-group" filter="url(#flame-glow)">
        <path class="flame-outer" d="M10 26.5 C10 24.5 11 23.8 12.75 23.8 C14.5 23.8 15.5 24.5 15.5 26.5 C15.5 28 14.5 30 12.75 36 C11 30 10 28 10 26.5Z" fill="url(#flame-outer)"/>
        <path class="flame-core" d="M10.8 26 C10.8 24.8 11.5 24.2 12.75 24.2 C14 24.2 14.7 24.8 14.7 26 C14.7 27.2 14 28.8 12.75 33 C11.5 28.8 10.8 27.2 10.8 26Z" fill="url(#flame-core)"/>
      </g>
      <g class="flame-group flame-right-group" filter="url(#flame-glow)">
        <path class="flame-outer" d="M20.5 26.5 C20.5 24.5 21.5 23.8 23.25 23.8 C25 23.8 26 24.5 26 26.5 C26 28 25 30 23.25 36 C21.5 30 20.5 28 20.5 26.5Z" fill="url(#flame-outer)"/>
        <path class="flame-core" d="M21.3 26 C21.3 24.8 22 24.2 23.25 24.2 C24.5 24.2 25.2 24.8 25.2 26 C25.2 27.2 24.5 28.8 23.25 33 C22 28.8 21.3 27.2 21.3 26Z" fill="url(#flame-core)"/>
      </g>

      <g>
        <circle cx="12.75" cy="33" r="0.45" fill="#FFF3B0" opacity="0">
          <animate attributeName="cy" values="33;42" dur="0.5s" repeatCount="indefinite"/>
          <animate attributeName="cx" values="12.75;11.5" dur="0.5s" repeatCount="indefinite"/>
          <animate attributeName="opacity" values="1;0" dur="0.5s" repeatCount="indefinite"/>
        </circle>
        <circle cx="12.75" cy="33" r="0.35" fill="#FFD700" opacity="0">
          <animate attributeName="cy" values="33;41" dur="0.4s" begin="0.1s" repeatCount="indefinite"/>
          <animate attributeName="cx" values="12.75;14" dur="0.4s" begin="0.1s" repeatCount="indefinite"/>
          <animate attributeName="opacity" values="1;0" dur="0.4s" begin="0.1s" repeatCount="indefinite"/>
        </circle>
        <circle cx="12.75" cy="33" r="0.4" fill="#FFF3B0" opacity="0">
          <animate attributeName="cy" values="33;43" dur="0.55s" begin="0.22s" repeatCount="indefinite"/>
          <animate attributeName="cx" values="12.75;12" dur="0.55s" begin="0.22s" repeatCount="indefinite"/>
          <animate attributeName="opacity" values="0.9;0" dur="0.55s" begin="0.22s" repeatCount="indefinite"/>
        </circle>
        <circle cx="12.75" cy="33" r="0.3" fill="#FFB347" opacity="0">
          <animate attributeName="cy" values="33;40" dur="0.35s" begin="0.32s" repeatCount="indefinite"/>
          <animate attributeName="cx" values="12.75;13.5" dur="0.35s" begin="0.32s" repeatCount="indefinite"/>
          <animate attributeName="opacity" values="1;0" dur="0.35s" begin="0.32s" repeatCount="indefinite"/>
        </circle>
        <circle cx="12.75" cy="33" r="0.25" fill="#FFF3B0" opacity="0">
          <animate attributeName="cy" values="33;41.5" dur="0.45s" begin="0.15s" repeatCount="indefinite"/>
          <animate attributeName="cx" values="12.75;11.8" dur="0.45s" begin="0.15s" repeatCount="indefinite"/>
          <animate attributeName="opacity" values="0.8;0" dur="0.45s" begin="0.15s" repeatCount="indefinite"/>
        </circle>
        <circle cx="12.75" cy="33" r="0.5" fill="#FFFFFF" opacity="0">
          <animate attributeName="cy" values="33;44" dur="0.6s" begin="0.05s" repeatCount="indefinite"/>
          <animate attributeName="cx" values="12.75;12.75" dur="0.6s" begin="0.05s" repeatCount="indefinite"/>
          <animate attributeName="opacity" values="0.7;0" dur="0.6s" begin="0.05s" repeatCount="indefinite"/>
        </circle>

        <circle cx="23.25" cy="33" r="0.45" fill="#FFF3B0" opacity="0">
          <animate attributeName="cy" values="33;42" dur="0.48s" begin="0.06s" repeatCount="indefinite"/>
          <animate attributeName="cx" values="23.25;24.5" dur="0.48s" begin="0.06s" repeatCount="indefinite"/>
          <animate attributeName="opacity" values="1;0" dur="0.48s" begin="0.06s" repeatCount="indefinite"/>
        </circle>
        <circle cx="23.25" cy="33" r="0.35" fill="#FFD700" opacity="0">
          <animate attributeName="cy" values="33;41" dur="0.42s" begin="0.18s" repeatCount="indefinite"/>
          <animate attributeName="cx" values="23.25;22" dur="0.42s" begin="0.18s" repeatCount="indefinite"/>
          <animate attributeName="opacity" values="1;0" dur="0.42s" begin="0.18s" repeatCount="indefinite"/>
        </circle>
        <circle cx="23.25" cy="33" r="0.4" fill="#FFF3B0" opacity="0">
          <animate attributeName="cy" values="33;43" dur="0.52s" begin="0.28s" repeatCount="indefinite"/>
          <animate attributeName="cx" values="23.25;24" dur="0.52s" begin="0.28s" repeatCount="indefinite"/>
          <animate attributeName="opacity" values="0.9;0" dur="0.52s" begin="0.28s" repeatCount="indefinite"/>
        </circle>
        <circle cx="23.25" cy="33" r="0.3" fill="#FFB347" opacity="0">
          <animate attributeName="cy" values="33;40" dur="0.38s" begin="0.38s" repeatCount="indefinite"/>
          <animate attributeName="cx" values="23.25;22.5" dur="0.38s" begin="0.38s" repeatCount="indefinite"/>
          <animate attributeName="opacity" values="1;0" dur="0.38s" begin="0.38s" repeatCount="indefinite"/>
        </circle>
        <circle cx="23.25" cy="33" r="0.25" fill="#FFF3B0" opacity="0">
          <animate attributeName="cy" values="33;41.5" dur="0.44s" begin="0.12s" repeatCount="indefinite"/>
          <animate attributeName="cx" values="23.25;24.2" dur="0.44s" begin="0.12s" repeatCount="indefinite"/>
          <animate attributeName="opacity" values="0.8;0" dur="0.44s" begin="0.12s" repeatCount="indefinite"/>
        </circle>
        <circle cx="23.25" cy="33" r="0.5" fill="#FFFFFF" opacity="0">
          <animate attributeName="cy" values="33;44" dur="0.58s" begin="0.42s" repeatCount="indefinite"/>
          <animate attributeName="cx" values="23.25;23.25" dur="0.58s" begin="0.42s" repeatCount="indefinite"/>
          <animate attributeName="opacity" values="0.7;0" dur="0.58s" begin="0.42s" repeatCount="indefinite"/>
        </circle>
      </g>
    </svg>
  </div>
</div>

<style>
  .rocket-container {
    --rocket-size: 120px;
    display: inline-flex;
    align-items: center;
    justify-content: center;
    position: relative;
    width: var(--rocket-size);
    height: var(--rocket-size);
  }

  .rocket-wrapper {
    width: 100%;
    height: 100%;
    animation: rocket-bounce 3s cubic-bezier(0.45, 0, 0.55, 1) infinite;
  }

  .rocket-svg {
    width: 100%;
    height: 100%;
    overflow: visible;
  }

  /* --- Right eye wink only --- */
  .wink-eye {
    animation: wink-open 4s step-end infinite;
  }

  .wink-closed {
    opacity: 0;
    animation: wink-shut 4s step-end infinite;
  }

  @keyframes wink-open {
    0%, 100% { opacity: 1; }
    90% { opacity: 0; }
    95% { opacity: 1; }
  }

  @keyframes wink-shut {
    0%, 100% { opacity: 0; }
    90% { opacity: 1; }
    95% { opacity: 0; }
  }

  /* --- Flame flicker --- */
  .flame-group {
    transform-origin: center 24px;
  }

  .flame-left-group {
    animation: flame-dance-a 0.12s ease-in-out infinite alternate;
  }

  .flame-right-group {
    animation: flame-dance-b 0.14s ease-in-out infinite alternate;
  }

  .flame-core {
    animation: flame-core-pulse 0.18s ease-in-out infinite alternate;
    transform-origin: center 24px;
  }

  @keyframes flame-dance-a {
    0%   { transform: scaleY(1) scaleX(1) translateX(0); }
    100% { transform: scaleY(1.15) scaleX(0.9) translateX(-0.3px); }
  }

  @keyframes flame-dance-b {
    0%   { transform: scaleY(1.1) scaleX(0.92) translateX(0.2px); }
    100% { transform: scaleY(1) scaleX(1.05) translateX(-0.15px); }
  }

  @keyframes flame-core-pulse {
    0%   { opacity: 1; transform: scaleY(1); }
    100% { opacity: 0.85; transform: scaleY(1.1); }
  }


  /* --- Main bounce --- */
  @keyframes rocket-bounce {
    0%, 100% {
      transform: translateY(0) rotate(-1.5deg);
    }
    20% {
      transform: translateY(-10px) rotate(0.5deg);
    }
    40% {
      transform: translateY(-3px) rotate(-0.8deg);
    }
    60% {
      transform: translateY(-14px) rotate(1.2deg);
    }
    80% {
      transform: translateY(-5px) rotate(-0.3deg);
    }
  }
</style>
